import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Read the Excel file
df = pd.read_excel('AI_caddie_shot_data_test.xlsx')

# Create a combined tag column for color-coding
df['tag'] = df['club'] + ' - ' + df['shot type']

# Get unique players
players = df['Player'].unique()

# Define column names
carry_col = 'carry distance (yards)'
side_col = 'Carry Side (ft)'

# Plot for each player
for player in players:
    player_df = df[df['Player'] == player]
    plt.figure(figsize=(10, 6))
    sns.scatterplot(x=side_col, y=carry_col, hue='tag', data=player_df)
    plt.axvline(x=0, color='gray', linestyle='--')  # Target line
    plt.title(f'Shot Dispersion for {player}')
    plt.xlabel('Carry Side (ft)')
    plt.ylabel('Carry Distance (yards)')
    plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')  # Legend outside plot
    plt.tight_layout()
    plt.show()
